System.register("chunks:///_virtual/AudioController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,n,t,r,o,u,l,s,a;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,u=e._decorator,l=e.AudioSource,s=e.AudioClip,a=e.Component}],execute:function(){var f,c,g,p,m,b,h,S,y,x,d,B,v,I,z,w,C,F,_,G,A,T,D,E,M;o._RF.push({},"f8bf2Ju7sNFXIGgo8lJ81kZ","AudioController",void 0);var V=u.ccclass,W=u.property;e("AudioController",(f=V("AudioController"),c=W(l),g=W(l),p=W(s),m=W(s),b=W(s),h=W(s),S=W(s),y=W(s),x=W(s),d=W(s),B=W(s),f((z=i((I=function(e){function i(){for(var i,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return i=e.call.apply(e,[this].concat(o))||this,t(i,"bgmSource",z,r(i)),t(i,"sfxSource",w,r(i)),t(i,"bgm1",C,r(i)),t(i,"bgm2",F,r(i)),t(i,"sfxBtn",_,r(i)),t(i,"sfxSpin",G,r(i)),t(i,"sfxWin",A,r(i)),t(i,"fgTriggerSfx",T,r(i)),t(i,"fgBgm1",D,r(i)),t(i,"fgBgm2",E,r(i)),t(i,"sfxCoinIn",M,r(i)),i._currentBgmIndex=0,i._isInFreeGame=!1,i}n(i,e);var o=i.prototype;return o.onLoad=function(){this.bgmSource&&(this.bgmSource.node.on(l.EventType.ENDED,this.onBgmEnded,this),this.playBgm(0))},o.setFreeGameMode=function(e){this._isInFreeGame!==e&&(this._isInFreeGame=e,this.playBgm(0))},o.playFreeGameTrigger=function(){this.playSfx(this.fgTriggerSfx)},o.playBgm=function(e){if(this.bgmSource){this._currentBgmIndex=e;var i=null;(i=this._isInFreeGame?0===e?this.fgBgm1:this.fgBgm2:0===e?this.bgm1:this.bgm2)&&(this.bgmSource.stop(),this.bgmSource.clip=i,this.bgmSource.loop=!1,this.bgmSource.play())}},o.onBgmEnded=function(){var e=(this._currentBgmIndex+1)%2;this.playBgm(e)},o.playBtnSound=function(){this.playSfx(this.sfxBtn)},o.playSpinSound=function(){this.playSfx(this.sfxSpin)},o.playWinSound=function(){this.playSfx(this.sfxWin)},o.playSfx=function(e){this.sfxSource&&e&&this.sfxSource.playOneShot(e)},o.playCoinIn=function(){this.sfxSource&&this.sfxCoinIn&&this.sfxSource.playOneShot(this.sfxCoinIn)},o.setBGMVolume=function(e){this.bgmSource&&(this.bgmSource.volume=e)},o.getBGMVolume=function(){return this.bgmSource?this.bgmSource.volume:1},o.setSFXVolume=function(e){this.sfxSource&&(this.sfxSource.volume=e)},o.getSFXVolume=function(){return this.sfxSource?this.sfxSource.volume:1},i}(a)).prototype,"bgmSource",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=i(I.prototype,"sfxSource",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(I.prototype,"bgm1",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=i(I.prototype,"bgm2",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(I.prototype,"sfxBtn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(I.prototype,"sfxSpin",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(I.prototype,"sfxWin",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(I.prototype,"fgTriggerSfx",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=i(I.prototype,"fgBgm1",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=i(I.prototype,"fgBgm2",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=i(I.prototype,"sfxCoinIn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=I))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/AutoSpinState.ts",["cc","./EventBus.ts"],(function(n){var t,i,e;return{setters:[function(n){t=n.cclegacy},function(n){i=n.EventBus,e=n.GameEvent}],execute:function(){t._RF.push({},"8affd8LfZJC57mZL1BrSQli","AutoSpinState",void 0);n("AutoSpinState",function(){function n(){this._isAutoSpinning=!1}var t=n.prototype;return t.enter=function(n){this._isAutoSpinning=!0,n.setSpinButtonInteractable(!1),i.instance.emit(e.SPIN_REQUEST)},t.exit=function(n){this._isAutoSpinning=!1,n.setSpinButtonInteractable(!0)},t.onSpinClicked=function(n){},t.onSpinEnded=function(n){var t=this;this._isAutoSpinning&&n.scheduleOnce((function(){t._isAutoSpinning&&i.instance.emit(e.SPIN_REQUEST)}),.5)},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/EventBus.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,i;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy,i=t.EventTarget}],execute:function(){e._RF.push({},"99977WB32VE9pEucfmWa95I","EventBus",void 0);t("GameEvent",function(t){return t.SPIN_REQUEST="SPIN_REQUEST",t.SPIN_STARTED="SPIN_STARTED",t.SPIN_ENDED="SPIN_ENDED",t.BALANCE_CHANGED="BALANCE_CHANGED",t.WIN_CHANGED="WIN_CHANGED",t.GRID_UPDATED="GRID_UPDATED",t.SHOW_WIN_EFFECTS="SHOW_WIN_EFFECTS",t}({}));t("EventBus",function(){function t(){this._target=new i}var e=t.prototype;return e.on=function(t,n,e){this._target.on(t,n,e)},e.off=function(t,n,e){this._target.off(t,n,e)},e.emit=function(t){for(var n,e=arguments.length,i=new Array(e>1?e-1:0),E=1;E<e;E++)i[E-1]=arguments[E];(n=this._target).emit.apply(n,[t].concat(i))},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/GameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SlotModel.ts","./SlotView.ts","./EventBus.ts","./IdleState.ts","./SpinningState.ts","./AudioController.ts"],(function(t){var e,n,i,o,a,s,l,r,u,d,h,c,p,g,f,b,m,B,S,C,_,v,y,N,w,T,F;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,l=t.Button,r=t.Label,u=t.Prefab,d=t.Node,h=t.Slider,c=t.UIOpacity,p=t.tween,g=t.director,f=t.UITransform,b=t.Vec3,m=t.instantiate,B=t.Color,S=t.Sprite,C=t.Component},function(t){_=t.SlotModel},function(t){v=t.SlotView},function(t){y=t.EventBus,N=t.GameEvent},function(t){w=t.IdleState},function(t){T=t.SpinningState},function(t){F=t.AudioController}],execute:function(){var P,L,E,G,M,A,I,V,k,R,z,U,O,D,x,W,H,K,j,Q,X,q,J,Y,Z,$,tt,et,nt,it,ot,at,st,lt,rt,ut,dt,ht,ct,pt,gt,ft,bt,mt,Bt,St,Ct,_t,vt,yt,Nt,wt,Tt,Ft,Pt,Lt,Et,Gt,Mt,At,It,Vt,kt,Rt,zt,Ut,Ot,Dt,xt,Wt,Ht,Kt,jt;a._RF.push({},"9f6f0Qei3FE5oGNFCdHKE9r","GameController",void 0);var Qt=s.ccclass,Xt=s.property,qt=[10,20,50,100,200,500];t("GameController",(P=Qt("GameController"),L=Xt(v),E=Xt(F),G=Xt(l),M=Xt(l),A=Xt(l),I=Xt(l),V=Xt(l),k=Xt(l),R=Xt(r),z=Xt(r),U=Xt(r),O=Xt(l),D=Xt(r),x=Xt(u),W=Xt(d),H=Xt(d),K=Xt(d),j=Xt(r),Q=Xt(u),X=Xt(l),q=Xt(l),J=Xt(l),Y=Xt(d),Z=Xt(d),$=Xt(r),tt=Xt(d),et=Xt(d),nt=Xt(l),it=Xt(h),ot=Xt(h),at=Xt(d),st=Xt(r),lt=Xt(d),rt=Xt(r),ut=Xt(l),P((ct=e((ht=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,i(e,"slotView",ct,o(e)),i(e,"audioController",pt,o(e)),i(e,"spinButton",gt,o(e)),i(e,"betButton",ft,o(e)),i(e,"autoButton",bt,o(e)),i(e,"speedButton0",mt,o(e)),i(e,"speedButton1",Bt,o(e)),i(e,"speedButton2",St,o(e)),i(e,"balanceValueLabel",Ct,o(e)),i(e,"winValueLabel",_t,o(e)),i(e,"betValueLabel",vt,o(e)),i(e,"coinBagButton",yt,o(e)),i(e,"coinBagTimeLabel",Nt,o(e)),i(e,"coinPrefab",wt,o(e)),i(e,"coinSprite",Tt,o(e)),i(e,"bonusFrameNode",Ft,o(e)),i(e,"reelMaskNode",Pt,o(e)),i(e,"bonusNumberLabel",Lt,o(e)),i(e,"bonusPlusOnePrefab",Et,o(e)),i(e,"settingsBtn",Gt,o(e)),i(e,"settingsLabelBtn",Mt,o(e)),i(e,"directionsLabelBtn",At,o(e)),i(e,"soundPageNode",It,o(e)),i(e,"directionsPageNode",Vt,o(e)),i(e,"directionsLabel",kt,o(e)),i(e,"settingsPageNode",Rt,o(e)),i(e,"settingsFrameNode",zt,o(e)),i(e,"settingsCloseBtn",Ut,o(e)),i(e,"musicSlider",Ot,o(e)),i(e,"effectsSlider",Dt,o(e)),i(e,"winTotalFrameNode",xt,o(e)),i(e,"winTotalLabel",Wt,o(e)),i(e,"freeGameTotalNode",Ht,o(e)),i(e,"freeGameTotalLabel",Kt,o(e)),i(e,"freeGameTotalBtn",jt,o(e)),e._coinBagTimer=90,e._isCoinBagReady=!1,e._coinBagTween=null,e._pendingBonusPositions=[],e._model=null,e._currentState=null,e._idleState=new w,e._spinningState=new T,e._betIndex=0,e._isAutoSpinning=!1,e._speedMode=0,e._canSpin=!0,e._canBet=!0,e._canAuto=!0,e._canSpeed=!0,e}n(e,t);var a=e.prototype;return a.onLoad=function(){if(this.slotView){var t=this.slotView.symbolFrames.length;this._model=new _(t),this.changeState(this._idleState),y.instance.on("FREE_GAME_UI_UPDATE",this.onFreeGameUIUpdate,this),y.instance.on("FREE_GAME_COUNT_CHANGED",this.onFreeGameCountChanged,this),y.instance.on("BONUS_COLLECTED",this.onBonusCollected,this),this.bonusFrameNode&&(this.bonusFrameNode.active=!1),this.bonusNumberLabel&&(this.bonusNumberLabel.string=""),this.winTotalFrameNode&&(this.winTotalFrameNode.active=!1),this.freeGameTotalNode&&(this.freeGameTotalNode.active=!1),this.winTotalLabel&&(this.winTotalLabel.string="0"),y.instance.on("FREE_GAME_ACCUMULATED_WIN_UPDATE",this.onAccumulatedWinUpdate,this),this.spinButton&&this.spinButton.node.on(l.EventType.CLICK,this.onSpinButtonClicked,this),this.betButton&&this.betButton.node.on(l.EventType.CLICK,this.onBetClicked,this),this.autoButton&&this.autoButton.node.on(l.EventType.CLICK,this.onAutoClicked,this),this.speedButton0&&this.speedButton0.node.on(l.EventType.CLICK,this.onSpeed0Clicked,this),this.speedButton1&&this.speedButton1.node.on(l.EventType.CLICK,this.onSpeed1Clicked,this),this.speedButton2&&this.speedButton2.node.on(l.EventType.CLICK,this.onSpeed2Clicked,this),y.instance.on(N.SPIN_REQUEST,this.onSpinRequest,this),y.instance.on(N.BALANCE_CHANGED,this.onBalanceChanged,this),y.instance.on(N.WIN_CHANGED,this.onWinChanged,this),y.instance.on(N.GRID_UPDATED,this.onGridUpdated,this),y.instance.on(N.SPIN_ENDED,this.onSpinEnded,this),y.instance.on(N.SHOW_WIN_EFFECTS,this.onShowWinEffects,this),this._model&&(this.updateBetDisplay(),this.onBalanceChanged(this._model.balance),this.onWinChanged(this._model.lastWin)),this.coinBagButton&&this.coinBagButton.node.on(l.EventType.CLICK,this.onCoinBagClicked,this),this.freeGameTotalBtn&&this.freeGameTotalBtn.node.on(l.EventType.CLICK,this.onFreeGameTotalBtnClicked,this),this.settingsBtn&&this.settingsBtn.node.on(l.EventType.CLICK,this.onSettingsClicked,this),this.settingsLabelBtn&&this.settingsLabelBtn.node.on(l.EventType.CLICK,this.onSettingsLabelClicked,this),this.directionsLabelBtn&&this.directionsLabelBtn.node.on(l.EventType.CLICK,this.onDirectionsLabelClicked,this),this.settingsCloseBtn&&this.settingsCloseBtn.node.on(l.EventType.CLICK,this.onSettingsCloseClicked,this),this.settingsPageNode&&(this.settingsPageNode.on(d.EventType.TOUCH_END,this.onSettingsPageClicked,this),this.settingsPageNode.active=!1),this.musicSlider&&this.musicSlider.node.on("slide",this.onMusicSliderChanged,this),this.effectsSlider&&this.effectsSlider.node.on("slide",this.onEffectsSliderChanged,this),this.schedule(this.updateCoinBagTimer,1),this.setCoinBagReady(!1),this.updateCoinBagUI(),this.updateSpeedButtons()}else console.warn("GameController 請在 Inspector 指定 SlotView")},a.onDestroy=function(){y.instance.off(N.SPIN_REQUEST,this.onSpinRequest,this),y.instance.off(N.BALANCE_CHANGED,this.onBalanceChanged,this),y.instance.off(N.WIN_CHANGED,this.onWinChanged,this),y.instance.off(N.GRID_UPDATED,this.onGridUpdated,this),y.instance.off(N.SPIN_ENDED,this.onSpinEnded,this),y.instance.off(N.SHOW_WIN_EFFECTS,this.onShowWinEffects,this)},a.changeState=function(t){this._currentState&&this._currentState.exit(this),this._currentState=t,this._currentState&&this._currentState.enter(this)},a.onSpinButtonClicked=function(){var t;this._canSpin?(null==(t=this.audioController)||t.playBtnSound(),this._currentState&&this._currentState.onSpinClicked(this)):this.playRejectAnimation(this.spinButton.node)},a.onBetClicked=function(){var t;this._canBet?(null==(t=this.audioController)||t.playBtnSound(),this._betIndex=(this._betIndex+1)%qt.length,this.updateBetDisplay()):this.playRejectAnimation(this.betButton.node)},a.onAutoClicked=function(){var t;if(this._canAuto){null==(t=this.audioController)||t.playBtnSound(),this._isAutoSpinning=!this._isAutoSpinning,console.log("Auto Spin:",this._isAutoSpinning);var e=this._currentState===this._idleState;this.setSpinButtonInteractable(e),this._isAutoSpinning&&this._currentState===this._idleState&&y.instance.emit(N.SPIN_REQUEST)}else this.playRejectAnimation(this.autoButton.node)},a.onSpeed0Clicked=function(){var t,e;this._canSpeed?(null==(t=this.audioController)||t.playBtnSound(),this._speedMode=1,null==(e=this.slotView)||e.setSpeedMode(1),this.updateSpeedButtons()):this.speedButton0&&this.playRejectAnimation(this.speedButton0.node)},a.onSpeed1Clicked=function(){var t,e;this._canSpeed?(null==(t=this.audioController)||t.playBtnSound(),this._speedMode=2,null==(e=this.slotView)||e.setSpeedMode(2),this.updateSpeedButtons()):this.speedButton1&&this.playRejectAnimation(this.speedButton1.node)},a.onSpeed2Clicked=function(){var t,e;this._canSpeed?(null==(t=this.audioController)||t.playBtnSound(),this._speedMode=0,null==(e=this.slotView)||e.setSpeedMode(0),this.updateSpeedButtons()):this.speedButton2&&this.playRejectAnimation(this.speedButton2.node)},a.updateSpeedButtons=function(){this.speedButton0&&(this.speedButton0.node.active=0===this._speedMode),this.speedButton1&&(this.speedButton1.node.active=1===this._speedMode),this.speedButton2&&(this.speedButton2.node.active=2===this._speedMode)},a.updateBetDisplay=function(){if(this._model){var t=qt[this._betIndex];this._model.baseBet=t,this.betValueLabel&&(this.betValueLabel.string=t.toString())}},a.onSpinRequest=function(){var t;if(this._model&&this.slotView){var e=9*this._model.baseBet;if(this._model.balance<e)return console.warn("餘額不足"),this._isAutoSpinning=!1,this.setSpinButtonInteractable(!0),void(this.balanceValueLabel&&this.playRejectAnimation(this.balanceValueLabel.node));null==(t=this.audioController)||t.playSpinSound(),this.changeState(this._spinningState);var n=this._model.spin();this.slotView.startSpinWithResult(n)}},a.onBalanceChanged=function(t){this.balanceValueLabel&&(this.balanceValueLabel.string=t.toString())},a.onWinChanged=function(t){this.winValueLabel&&(this.winValueLabel.string=t.toString())},a.onShowWinEffects=function(){var t;null==(t=this.audioController)||t.playWinSound()},a.onGridUpdated=function(t){},a.onSpinEnded=function(){var t=this;if(this.changeState(this._idleState),this._model&&this._model.isInFreeGame){var e=1;this._pendingBonusPositions.length>0&&(e=this.processPendingBonuses()+.5),this.scheduleOnce((function(){t.tryAutoSpin()}),e)}else this._isAutoSpinning&&this.scheduleOnce((function(){t._isAutoSpinning&&t._currentState===t._idleState&&y.instance.emit(N.SPIN_REQUEST)}),.5)},a.setSpinButtonInteractable=function(t){var e=!!this._model&&this._model.isInFreeGame;this._canSpin=t&&!this._isAutoSpinning&&!e,this._canBet=t&&!this._isAutoSpinning&&!e,this._canSpeed=t&&!this._isAutoSpinning&&!e,this._canAuto=(this._isAutoSpinning||t)&&!e,this.updateButtonVisual(this.spinButton,this._canSpin),this.updateButtonVisual(this.betButton,this._canBet),this.updateButtonVisual(this.autoButton,this._canAuto),this.updateButtonVisual(this.speedButton0,this._canSpeed),this.updateButtonVisual(this.speedButton1,this._canSpeed),this.updateButtonVisual(this.speedButton2,this._canSpeed)},a.updateButtonVisual=function(t,e){if(t){t.interactable=!0;var n=t.getComponent(c);if(n)n.opacity=e?255:150;else(t.node.getComponent(c)||t.node.addComponent(c)).opacity=e?255:150}},a.playRejectAnimation=function(t){p(t).stop(),p(t).to(.05,{angle:15}).to(.1,{angle:-15}).to(.1,{angle:10}).to(.1,{angle:-10}).to(.05,{angle:0}).start()},a.updateCoinBagTimer=function(){this._isCoinBagReady||(this._coinBagTimer--,this._coinBagTimer<=0&&(this._coinBagTimer=0,this.setCoinBagReady(!0)),this.updateCoinBagUI())},a.updateCoinBagUI=function(){if(this.coinBagTimeLabel){var t=Math.floor(this._coinBagTimer/60),e=this._coinBagTimer%60,n=e<10?"0"+e:e.toString();this.coinBagTimeLabel.string=t+":"+n}},a.setCoinBagReady=function(t){this._isCoinBagReady=t,this.updateButtonVisual(this.coinBagButton,t),t?this.coinBagButton&&this.startCoinBagShake(this.coinBagButton.node):this.coinBagButton&&this.stopCoinBagShake(this.coinBagButton.node)},a.startCoinBagShake=function(t){this._coinBagTween&&this._coinBagTween.stop(),t.angle=0,this._coinBagTween=p(t).to(.1,{angle:10}).to(.1,{angle:-10}).to(.1,{angle:10}).to(.1,{angle:-10}).union().repeatForever().start()},a.stopCoinBagShake=function(t){this._coinBagTween&&(this._coinBagTween.stop(),this._coinBagTween=null),t.angle=0},a.onCoinBagClicked=function(){var t;this._isCoinBagReady?(null==(t=this.audioController)||t.playWinSound(),this.coinBagButton&&this.coinSprite&&this.playCoinFlyEffect(this.coinBagButton.node,this.coinSprite),this._model&&(this._model.addBalance(500),y.instance.emit(N.BALANCE_CHANGED,this._model.balance)),this._coinBagTimer=90,this.setCoinBagReady(!1),this.updateCoinBagUI()):this.coinBagButton&&this.playRejectAnimation(this.coinBagButton.node)},a.playCoinFlyEffect=function(t,e){var n=this;if(this.coinPrefab){for(var i=this.node.parent;i&&"Canvas"!==i.name&&i.parent;)i=i.parent;if(!i||"Canvas"!==i.name){var o,a=null==(o=g.getScene())?void 0:o.getChildByName("Canvas");a&&(i=a)}if(i||(i=this.node.parent),i){var s=i.getComponent(f);if(s)for(var l=t.worldPosition,r=e.worldPosition,u=s.convertToNodeSpaceAR(l),d=s.convertToNodeSpaceAR(r),h=function(){var t=m(n.coinPrefab);t.setParent(i),t.setSiblingIndex(9999),t.setPosition(u),t.setScale(new b(0,0,0));var e=Math.random()*Math.PI*2,o=100+150*Math.random(),a=Math.cos(e)*o,s=Math.sin(e)*o,l=new b(u.x+a,u.y+s,0),r=.3+.2*Math.random();p(t).to(.1,{scale:new b(1,1,1)}).to(r,{position:l},{easing:"backOut"}).delay(.1+.2*Math.random()).call((function(){n.runCoinFlyTween(t,l,d)})).start()},c=0;c<20;c++)h()}}},a.runCoinFlyTween=function(t,e,n){var i=this,o=e,a=n,s=(o.x+a.x)/2,l=(o.y+a.y)/2,r=300*(Math.random()-.5),u=300*(Math.random()-.5),d=new b(s+r,l+u,0),h=.6+.3*Math.random();p({t:0}).to(h,{t:1},{onUpdate:function(e){var n=e.t,i=1-n,s=i*i*o.x+2*i*n*d.x+n*n*a.x,l=i*i*o.y+2*i*n*d.y+n*n*a.y;t.isValid&&t.setPosition(s,l,0)},easing:"sineIn"}).call((function(){var e;t.isValid&&t.destroy(),null==(e=i.audioController)||e.playCoinIn(),i.coinSprite&&p(i.coinSprite).stop().to(.05,{scale:new b(1.3,1.3,1)}).to(.05,{scale:new b(1,1,1)}).start()})).start(),p(t).to(h,{scale:new b(.5,.5,.5)}).start()},a.tryAutoSpin=function(){this._currentState===this._idleState&&y.instance.emit(N.SPIN_REQUEST)},a.onFreeGameUIUpdate=function(t,e){var n,i,o=this;(this.bonusNumberLabel&&(this.bonusNumberLabel.string=e.toString()),this.bonusFrameNode)&&(t?(this.winTotalFrameNode&&(this.winTotalFrameNode.active=!0),this.winTotalLabel&&(this.winTotalLabel.string="0"),null==(n=this.audioController)||n.playFreeGameTrigger(),null==(i=this.audioController)||i.setFreeGameMode(!0),this.scheduleOnce((function(){o.playBullionRainEffect((function(){o.bonusFrameNode&&(o.bonusFrameNode.active=!0,o.bonusFrameNode.setScale(0,0,1),p(o.bonusFrameNode).to(.3,{scale:new b(1.2,1.2,1)},{easing:"backOut"}).to(.1,{scale:new b(1,1,1)},{easing:"sineOut"}).start()),o.scheduleOnce((function(){o.tryAutoSpin()}),1.5)}))}),2.5)):this.showFreeGameResultPopup())},a.onAccumulatedWinUpdate=function(t){this.winTotalLabel&&(this.winTotalLabel.string=t.toString())},a.showFreeGameResultPopup=function(){var t,e=this;if(null==(t=this.audioController)||t.setFreeGameMode(!1),this.bonusFrameNode&&(this.bonusFrameNode.active=!1),this.freeGameTotalNode){this.freeGameTotalNode.active=!0,this.freeGameTotalNode.setScale(0,0,1),p(this.freeGameTotalNode).to(.3,{scale:new b(1.2,1.2,1)},{easing:"backOut"}).to(.1,{scale:new b(1,1,1)},{easing:"sineOut"}).start();var n=this._model?this._model.freeGameAccumulatedWin:0;if(this.freeGameTotalLabel){this.freeGameTotalLabel.string="0";p({val:0}).to(1.5,{val:n},{onUpdate:function(t){e.freeGameTotalLabel.string=Math.floor(t.val).toString()},easing:"cubicOut"}).start()}this.scheduleOnce((function(){e.freeGameTotalNode&&e.freeGameTotalNode.active&&e.onFreeGameTotalClose()}),10)}else this.onFreeGameTotalClose()},a.onFreeGameTotalClose=function(){this.freeGameTotalNode&&(this.freeGameTotalNode.active=!1),this._model&&this._model.claimFreeGameRewards(),this.winTotalFrameNode&&(this.winTotalFrameNode.active=!1)},a.onFreeGameCountChanged=function(t){this.bonusNumberLabel&&(this.bonusNumberLabel.string=t.toString())},a.onBonusCollected=function(t){this._pendingBonusPositions=t},a.processPendingBonuses=function(){var t=this,e=this._pendingBonusPositions;this._pendingBonusPositions=[];var n=0;return e.forEach((function(e,i){if(t.slotView){var o=t.slotView.getSymbolNode(e.r,e.c);if(o&&t.bonusFrameNode){var a=.1*i,s=a+.5;s>n&&(n=s),t.scheduleOnce((function(){t.flyPlusOne(o,t.bonusFrameNode,i)}),a)}}})),n>0?n:0},a.flyPlusOne=function(t,e,n){var i,o,a=this;if(this.bonusPlusOnePrefab)o=m(this.bonusPlusOnePrefab);else{var s=(o=new d("PlusOne")).addComponent(r);s.string="+1",s.fontSize=50,s.color=new B(255,255,0,255)}for(var l=this.node.parent;l&&"Canvas"!==l.name&&l.parent;)l=l.parent;l||(l=null==(i=g.getScene())?void 0:i.getChildByName("Canvas")),l||(l=this.node),o.setParent(l);var u=l.getComponent(f),h=t.worldPosition,c=e.worldPosition,S=u.convertToNodeSpaceAR(h),C=u.convertToNodeSpaceAR(c);o.setPosition(S),o.setScale(0,0,1),p(o).to(.15,{scale:new b(1,1,1)},{easing:"backOut"}).delay(.05).to(.4,{position:C},{easing:"cubicIn"}).call((function(){var t;if(o.isValid&&o.destroy(),a.playBonusFrameHitEffect(),null==(t=a.audioController)||t.playBtnSound(),a.bonusNumberLabel){var e=parseInt(a.bonusNumberLabel.string)||0;a.bonusNumberLabel.string=(e+1).toString()}})).start()},a.playBonusFrameHitEffect=function(){this.bonusFrameNode&&p(this.bonusFrameNode).to(.1,{scale:new b(1.2,1.2,1)}).to(.1,{scale:new b(1,1,1)}).start()},a.onFreeGameTotalBtnClicked=function(){var t;null==(t=this.audioController)||t.playBtnSound(),this.onFreeGameTotalClose()},a.playBullionRainEffect=function(t){var e=this;if(this.reelMaskNode&&this.slotView){if(8>=this.slotView.symbolFrames.length)t();else{var n=this.slotView.symbolFrames[8],i=this.reelMaskNode.getComponent(f);if(i){for(var o=i.width,a=i.height,s=[],l=this._model?this._model.lastGrid:null,r=0;r<3;r++)for(var u=0;u<5;u++)if(!(l&&l.length>r&&7===l[r][u])){var h=this.slotView.getSymbolNode(r,u);if(h){var c=h.worldPosition,g=i.convertToNodeSpaceAR(c);s.push({pos:g,r:r,c:u})}}for(var m=s.length-1;m>0;m--){var B=Math.floor(Math.random()*(m+1)),C=[s[B],s[m]];s[m]=C[0],s[B]=C[1]}for(var _=Math.min(6+Math.floor(5*Math.random()),s.length),v=0,y=function(){var t=new d("BullionFX");t.addComponent(S).spriteFrame=n,t.setParent(e.reelMaskNode),t.setScale(.12,.12,1);var i=s[N],l=i.pos.x,r=i.pos.y,u=Math.floor(3*Math.random()),h=0,c=0,g=1500;0===u?(h=(Math.random()-.5)*o*2,c=a/2+g):1===u?(h=-o/2-g,c=(Math.random()-.5)*a*2):(h=o/2+g,c=(Math.random()-.5)*a*2),t.setPosition(h,c);var f=.6+.4*Math.random(),b=.3*Math.random(),m=(h+l)/2,B=Math.max(c,r)+300+300*Math.random(),C=720*Math.random()-360;f+b>v&&(v=f+b),p({t:0}).delay(b).to(f,{t:1},{easing:"sineOut",onUpdate:function(e){var n=e.t;if(t.isValid){var i=1-n,o=i*i*h+2*i*n*m+n*n*l,a=i*i*c+2*i*n*B+n*n*r;t.setPosition(o,a),t.angle=C*n}}}).call((function(){if(e.slotView&&t.isValid){var o=e.slotView.getSymbolNode(i.r,i.c);if(o){var a=o.getComponent("SymbolView");a&&a.setSymbol&&a.setSymbol(8,n)}t.destroy()}})).start()},N=0;N<_;N++)y();for(var w=function(){var t=new d("BullionFX_Decor");t.addComponent(S).spriteFrame=n,t.setParent(e.reelMaskNode),t.setScale(.12,.12,1);var i=(Math.random()-.5)*o,s=(Math.random()-.5)*a,l=Math.floor(3*Math.random()),r=0,u=0,h=1500;0===l?(r=(Math.random()-.5)*o*2,u=a/2+h):1===l?(r=-o/2-h,u=(Math.random()-.5)*a*2):(r=o/2+h,u=(Math.random()-.5)*a*2),t.setPosition(r,u);var c=.6+.4*Math.random(),g=.3*Math.random();c+g+.4>v&&(v=c+g+.4);var f=(r+i)/2,m=Math.max(u,s)+300+300*Math.random(),B=720*Math.random()-360;p({t:0}).delay(g).to(c,{t:1},{easing:"sineOut",onUpdate:function(e){var n=e.t;if(t.isValid){var o=1-n,a=o*o*r+2*o*n*f+n*n*i,l=o*o*u+2*o*n*m+n*n*s;t.setPosition(a,l),t.angle=B*n}}}).call((function(){t.isValid&&p(t).to(.2,{scale:new b(0,0,0)},{easing:"backIn"}).call((function(){return t.destroy()})).start()})).start()},T=0;T<8;T++)w();this.scheduleOnce(t,v+.2)}else t()}}else t()},a.onSettingsClicked=function(){var t;null==(t=this.audioController)||t.playBtnSound(),this.settingsPageNode&&(this.settingsPageNode.active=!0)},a.onSettingsLabelClicked=function(){var t;null==(t=this.audioController)||t.playBtnSound(),this.settingsPageNode&&(this.settingsPageNode.active=!1),this.settingsFrameNode&&(this.settingsFrameNode.active=!0,this.settingsFrameNode.setScale(0,0,1),p(this.settingsFrameNode).to(.3,{scale:new b(1,1,1)},{easing:"backOut"}).start()),this.soundPageNode&&(this.soundPageNode.active=!0),this.directionsPageNode&&(this.directionsPageNode.active=!1),this.audioController&&(this.musicSlider&&(this.musicSlider.progress=this.audioController.getBGMVolume()),this.effectsSlider&&(this.effectsSlider.progress=this.audioController.getSFXVolume()))},a.onDirectionsLabelClicked=function(){var t;if(null==(t=this.audioController)||t.playBtnSound(),this.settingsPageNode&&(this.settingsPageNode.active=!1),this.settingsFrameNode&&(this.settingsFrameNode.active=!0,this.settingsFrameNode.setScale(0,0,1),p(this.settingsFrameNode).to(.3,{scale:new b(1,1,1)},{easing:"backOut"}).start()),this.soundPageNode&&(this.soundPageNode.active=!1),this.directionsPageNode&&(this.directionsPageNode.active=!0),this.directionsLabel){this.directionsLabel.string="Christmas Slot 遊戲說明\n\n【基本規則】\n1. 遊戲架構：5 卷軸 x 3 行，共有 9 條賠付線。\n2. 連線規則：從最左側卷軸開始，連續出現 3 個或以上相同符號即為中獎。\n3. 賠率倍數：\n   - 3 連線：5 倍\n   - 4 連線：10 倍\n   - 5 連線：50 倍\n4. Wild 符號：可替代除 Bonus 與 Bullion 外的所有符號。\n\n【Free Game 免費遊戲】\n1. 觸發條件：在賠付線上連線 3 個或以上 Bonus 符號，即可觸發 15 次免費遊戲。\n2. 觸發獎勵倍數：\n   - 3 Bonus 連線：x1 倍\n   - 4 Bonus 連線：x2 倍\n   - 5 Bonus 連線：x3 倍\n   (此倍數影響 Free Game 中的 Bullion 獎勵)\n3. 金條雨 (Bullion Rain)：\n   - 進入 Free Game 前，隨機將盤面 6~10 個符號替換為 Bullion (金條)，大幅提升連線機會！\n4. Bullion (金條) 獎勵：\n   - 僅在 Free Game 出現。\n   - Bullion 連線賠率為「基礎倍率 x 2 x 觸發倍數」。最高可達 300 倍！\n5. 增加次數 (+1)：\n   - Free Game 期間，盤面只要出現 Bonus 符號（無需連線），每個 Bonus 增加 1 次遊戲機會。\n\n【其他功能】\n- 金錢袋：點擊畫面上的金錢袋圖示，立即獲得 500 免費金幣！\n- 自動旋轉：可切換不同轉速並自動進行遊戲。\n\n祝您聖誕快樂，大獎連連！"}},a.onSettingsCloseClicked=function(){var t,e=this;null==(t=this.audioController)||t.playBtnSound(),this.settingsFrameNode?p(this.settingsFrameNode).to(.2,{scale:new b(0,0,1)},{easing:"backIn"}).call((function(){e.settingsFrameNode.active=!1,e.settingsPageNode&&(e.settingsPageNode.active=!1)})).start():this.settingsPageNode&&(this.settingsPageNode.active=!1)},a.onSettingsPageClicked=function(){this.onSettingsCloseClicked()},a.onMusicSliderChanged=function(t){var e;null==(e=this.audioController)||e.setBGMVolume(t.progress)},a.onEffectsSliderChanged=function(t){var e;null==(e=this.audioController)||e.setSFXVolume(t.progress)},e}(C)).prototype,"slotView",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pt=e(ht.prototype,"audioController",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gt=e(ht.prototype,"spinButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ft=e(ht.prototype,"betButton",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bt=e(ht.prototype,"autoButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt=e(ht.prototype,"speedButton0",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bt=e(ht.prototype,"speedButton1",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),St=e(ht.prototype,"speedButton2",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ct=e(ht.prototype,"balanceValueLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_t=e(ht.prototype,"winValueLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vt=e(ht.prototype,"betValueLabel",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yt=e(ht.prototype,"coinBagButton",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nt=e(ht.prototype,"coinBagTimeLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wt=e(ht.prototype,"coinPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tt=e(ht.prototype,"coinSprite",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ft=e(ht.prototype,"bonusFrameNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pt=e(ht.prototype,"reelMaskNode",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Lt=e(ht.prototype,"bonusNumberLabel",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Et=e(ht.prototype,"bonusPlusOnePrefab",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Gt=e(ht.prototype,"settingsBtn",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mt=e(ht.prototype,"settingsLabelBtn",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),At=e(ht.prototype,"directionsLabelBtn",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),It=e(ht.prototype,"soundPageNode",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vt=e(ht.prototype,"directionsPageNode",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kt=e(ht.prototype,"directionsLabel",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rt=e(ht.prototype,"settingsPageNode",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zt=e(ht.prototype,"settingsFrameNode",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ut=e(ht.prototype,"settingsCloseBtn",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ot=e(ht.prototype,"musicSlider",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Dt=e(ht.prototype,"effectsSlider",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xt=e(ht.prototype,"winTotalFrameNode",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wt=e(ht.prototype,"winTotalLabel",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ht=e(ht.prototype,"freeGameTotalNode",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Kt=e(ht.prototype,"freeGameTotalLabel",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jt=e(ht.prototype,"freeGameTotalBtn",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=ht))||dt));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameState.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"98565nwcb5GLr/nowpipmxS","GameState",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/IdleState.ts",["cc","./EventBus.ts"],(function(t){var n,e,c;return{setters:[function(t){n=t.cclegacy},function(t){e=t.EventBus,c=t.GameEvent}],execute:function(){n._RF.push({},"9f2b04gN6dGtrh3BXZr348t","IdleState",void 0);t("IdleState",function(){function t(){}var n=t.prototype;return n.enter=function(t){t.setSpinButtonInteractable(!0)},n.exit=function(t){t.setSpinButtonInteractable(!1)},n.onSpinClicked=function(t){e.instance.emit(c.SPIN_REQUEST)},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioController.ts","./GameController.ts","./EventBus.ts","./SlotModel.ts","./AutoSpinState.ts","./GameState.ts","./IdleState.ts","./SpinningState.ts","./ObjectPool.ts","./SlotView.ts","./SymbolView.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/ObjectPool.ts",["cc"],(function(t){var e,o;return{setters:[function(t){e=t.cclegacy,o=t.instantiate}],execute:function(){e._RF.push({},"eacaahKiY5ByrxH4tL3BZBX","ObjectPool",void 0);t("ObjectPool",function(){function t(t){this._prefab=void 0,this._pool=[],this._prefab=t}var e=t.prototype;return e.acquire=function(t){var e;return e=this._pool.length>0?this._pool.pop():o(this._prefab),t&&(e.parent=t),e.active=!0,e},e.release=function(t){t.removeFromParent(),t.active=!1,this._pool.push(t)},e.clear=function(){this._pool.length=0},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/SlotModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventBus.ts"],(function(e){var t,i,n,s;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy},function(e){n=e.EventBus,s=e.GameEvent}],execute:function(){i._RF.push({},"6eecdJm0FlOuorgRSULpHV8","SlotModel",void 0);var a=e("COLS",5),r=e("ROWS",3),u=e("SYMBOL_WILD",6),_=e("SYMBOL_BONUS",7),l=e("SYMBOL_BULLION",8),c=[[0,1,2,3,4,6,0,1,2,3,5,0,1,2,4,5],[5,4,3,2,1,0,5,4,7,2,1,3,0,5,4,2],[1,3,5,0,2,4,1,6,3,5,0,2,4,1,3,5],[2,4,0,5,1,3,2,7,0,4,1,5,3,2,4,0],[0,2,4,1,3,5,0,6,2,4,7,1,3,5,0,2]],h=[[0,1,8,3,6,0,1,2,3,8,0,1,2,4,5],[5,8,3,2,1,0,5,4,7,8,1,3,0,5,4,2],[1,3,5,8,2,4,1,6,3,5,8,2,4,1,3,5],[2,4,8,5,1,3,2,7,0,8,1,5,3,2,4,0],[0,2,4,8,3,5,0,6,2,4,7,8,3,5,0,2]],o=e("PAY_LINES",[[1,1,1,1,1],[0,0,0,0,0],[2,2,2,2,2],[0,1,2,1,0],[2,1,0,1,2],[0,0,1,2,2],[2,2,1,0,0],[1,2,2,2,1],[1,0,0,0,1]]);e("SlotModel",function(){function e(e){this._balance=1e4,this._baseBet=10,this._lastWin=0,this._symbolCount=void 0,this._isInFreeGame=!1,this._freeGameCount=0,this._bonusTriggerMultiplier=1,this._freeGameAccumulatedWin=0,this._lastGrid=[],this._symbolCount=e}var i=e.prototype;return i.addBalance=function(e){this._balance+=e,n.instance.emit(s.BALANCE_CHANGED,this._balance)},i.spin=function(){var e=this,t=this._isInFreeGame;if(this._isInFreeGame)this._freeGameCount--,n.instance.emit("FREE_GAME_COUNT_CHANGED",this._freeGameCount);else{this._baseBet,o.length;this._balance-=100,this._balance<0&&(this._balance=0),n.instance.emit(s.BALANCE_CHANGED,this._balance)}for(var i=this._isInFreeGame?h:c,m=[],f=0;f<r;f++)m.push(new Array(a).fill(0));for(var G=0;G<a;G++)for(var A=i[G%i.length],b=Math.floor(Math.random()*A.length),E=0;E<r;E++){var C=A[(b+E)%A.length];this._symbolCount,m[E][G]=C}var g=[],d=0;if(this._isInFreeGame){for(var I=[],v=0;v<r;v++)for(var F=0;F<a;F++)m[v][F]===_&&I.push({r:v,c:F});I.length>0&&(this._freeGameCount+=I.length,setTimeout((function(){n.instance.emit("BONUS_COLLECTED",I)}),0))}for(var W=0;W<o.length;W++){for(var B=o[W],M=0,N=-1,L=0;L<a;L++){var p=m[B[L]][L];if(p===_||p===l)if(-1===N)N=p,M++;else{if(N!==p){if(N===u)break;break}M++}else if(p===u){if(N===_||N===l)break;M++}else{if(N===_||N===l)break;if(-1===N)N=p,M++;else{if(p!==N)break;M++}}}if(M>=3){var D=-1===N?u:N,y=0;3===M&&(y=5),4===M&&(y=10),5===M&&(y=50),D===_?this._isInFreeGame||(this._isInFreeGame=!0,this._isInFreeGame=!0,this._freeGameCount=15,this._freeGameAccumulatedWin=0,3===M&&(this._bonusTriggerMultiplier=1),4===M&&(this._bonusTriggerMultiplier=2),5===M&&(this._bonusTriggerMultiplier=3),setTimeout((function(){return n.instance.emit("FREE_GAME_UI_UPDATE",!0,e._freeGameCount)}),0)):D===l&&this._isInFreeGame&&(y*=2,y*=this._bonusTriggerMultiplier);var T=this._baseBet*y;d+=T,g.push({lineIndex:W,symbol:D,count:M,amount:T})}}return this._lastWin=d,this._lastGrid=m,t?(this._freeGameAccumulatedWin+=d,n.instance.emit(s.WIN_CHANGED,this._lastWin),n.instance.emit("FREE_GAME_ACCUMULATED_WIN_UPDATE",this._freeGameAccumulatedWin)):(this._balance+=d,n.instance.emit(s.BALANCE_CHANGED,this._balance),n.instance.emit(s.WIN_CHANGED,this._lastWin)),n.instance.emit(s.GRID_UPDATED,m),this._isInFreeGame&&this._freeGameCount<=0?(this._isInFreeGame=!1,setTimeout((function(){return n.instance.emit("FREE_GAME_UI_UPDATE",!1,0)}),0)):this._isInFreeGame,{grid:m,totalWin:d,winLines:g}},i.claimFreeGameRewards=function(){this._freeGameAccumulatedWin>0&&(this._balance+=this._freeGameAccumulatedWin,this._freeGameAccumulatedWin=0,n.instance.emit(s.BALANCE_CHANGED,this._balance))},t(e,[{key:"balance",get:function(){return this._balance}},{key:"lastWin",get:function(){return this._lastWin}},{key:"baseBet",get:function(){return this._baseBet},set:function(e){this._baseBet=e}},{key:"isInFreeGame",get:function(){return this._isInFreeGame}},{key:"freeGameCount",get:function(){return this._freeGameCount}},{key:"freeGameAccumulatedWin",get:function(){return this._freeGameAccumulatedWin}},{key:"lastGrid",get:function(){return this._lastGrid}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/SlotView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SlotModel.ts","./SymbolView.ts","./ObjectPool.ts","./EventBus.ts"],(function(t){var i,e,n,s,r,o,l,a,h,c,p,_,u,f,S,m,d,y,b,g,v,w,D,E;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,s=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,l=t._decorator,a=t.Node,h=t.Prefab,c=t.SpriteFrame,p=t.SpriteAtlas,_=t.CCString,u=t.Graphics,f=t.Color,S=t.Vec3,m=t.tween,d=t.Component},function(t){y=t.COLS,b=t.ROWS,g=t.PAY_LINES},function(t){v=t.SymbolView},function(t){w=t.ObjectPool},function(t){D=t.EventBus,E=t.GameEvent}],execute:function(){var P,F,W,G,A,R,N,H,C,I,T,L,O;o._RF.push({},"ebaf72mfyRKZYyDO/iHKDq0","SlotView",void 0);var Y=l.ccclass,B=l.property;t("SlotView",(P=Y("SlotView"),F=B(a),W=B(h),G=B([c]),A=B(p),R=B({type:_}),P((C=i((H=function(t){function i(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i=t.call.apply(t,[this].concat(n))||this,s(i,"gridRoot",C,r(i)),s(i,"symbolPrefab",I,r(i)),s(i,"symbolFrames",T,r(i)),s(i,"symbolAtlas",L,r(i)),s(i,"atlasPrefix",O,r(i)),i._pool=null,i._cells=[],i._lineGraphics=null,i._cellWidth=230,i._cellHeight=200,i._totalHeight=0,i._startX=0,i._startY=0,i._isSpinning=!1,i._columnSpinning=new Array(y).fill(!1),i._spinSpeed=1200,i._currentStopBaseDelay=1,i._currentStopStepDelay=.3,i._result=null,i._activeTweens=0,i}e(i,t);var o=i.prototype;return o.onLoad=function(){this.gridRoot&&this.symbolPrefab?(this._pool=new w(this.symbolPrefab),this.createGrid(),this.createGraphics(),D.instance.on(E.SPIN_STARTED,this.onSpinStarted,this),D.instance.on(E.SPIN_ENDED,this.onSpinEnded,this)):console.warn("SlotView 請指定 gridRoot 與 symbolPrefab")},o.onDestroy=function(){D.instance.off(E.SPIN_STARTED,this.onSpinStarted,this),D.instance.off(E.SPIN_ENDED,this.onSpinEnded,this)},o.getSymbolFrame=function(t){if(this.symbolAtlas){var i=this.atlasPrefix+t,e=this.symbolAtlas.getSpriteFrame(i);if(e||(e=this.symbolAtlas.getSpriteFrame(t.toString())),e)return e}return this.symbolFrames&&this.symbolFrames[t]?this.symbolFrames[t]:null},o.createGraphics=function(){if(this.gridRoot){var t=new a("WinLines");t.setParent(this.gridRoot),this._lineGraphics=t.addComponent(u),this._lineGraphics.lineWidth=10,this._lineGraphics.strokeColor=new f(255,215,0,255),this._lineGraphics.lineJoin=u.LineJoin.ROUND,this._lineGraphics.lineCap=u.LineCap.ROUND,t.setSiblingIndex(999)}},o.createGrid=function(){if(this.gridRoot&&this._pool){var t=this._cellWidth,i=this._cellHeight,e=y,n=b,s=e*t,r=n*i;this._totalHeight=r,this._startX=-s/2+t/2,this._startY=r/2-i/2,this._cells=[];for(var o=0;o<n;o++){for(var l=[],a=0;a<e;a++){var h=this._pool.acquire(this.gridRoot),c=this._startX+a*t,p=this._startY-o*i;h.setPosition(new S(c,p,0));var _=h.getComponent(v);if(_){var u=Math.floor(8*Math.random());8===u&&(u=0);var f=this.getSymbolFrame(u);_.setSymbol(u,f),l.push(_)}}this._cells.push(l)}}},o.getSymbolNode=function(t,i){return this._cells&&this._cells[t]&&this._cells[t][i]?this._cells[t][i].node:null},o.setSpeedMode=function(t){0===t?(this._spinSpeed=1200,this._currentStopBaseDelay=1,this._currentStopStepDelay=.3):1===t?(this._spinSpeed=1800,this._currentStopBaseDelay=.6,this._currentStopStepDelay=.2):2===t&&(this._spinSpeed=1800,this._currentStopBaseDelay=.3,this._currentStopStepDelay=0)},o.startSpinWithResult=function(t){var i=this;if(this._cells&&0!==this._cells.length&&(this.symbolFrames&&0!==this.symbolFrames.length||this.symbolAtlas)){this._result=t,this._activeTweens=0,this.stopAllWinEffects(),this._isSpinning=!0;for(var e=0;e<y;e++)this._columnSpinning[e]=!0;for(var n=this._currentStopBaseDelay,s=this._currentStopStepDelay,r=function(t){var e=n+t*s;i.scheduleOnce((function(){i.stopColumn(t)}),e)},o=0;o<y;o++)r(o)}},o.onSpinStarted=function(){},o.onSpinEnded=function(){},o.stopColumn=function(t){var i=this;if(this._isSpinning&&this._result){this._columnSpinning[t]=!1,this._activeTweens++;for(var e=0;e<b;e++){var n=this._cells[e][t],s=n.node,r=this._startX+t*this._cellWidth,o=this._startY-e*this._cellHeight,l=o+this._totalHeight;s.setPosition(new S(r,l,0));var a=this._result.grid[e][t],h=this.getSymbolFrame(a);n.setSymbol(a,h);var c=m(s).to(.4,{position:new S(r,o,0)},{easing:"backOut"});e===b-1&&c.call((function(){i._activeTweens--,i.checkAllStopped()})),c.start()}}},o.checkAllStopped=function(){for(var t=0;t<y;t++)if(this._columnSpinning[t])return;this._activeTweens>0||(this._isSpinning=!1,this._result&&this._result.totalWin>0?this.showWinAnimations(this._result.winLines):D.instance.emit(E.SPIN_ENDED))},o.showWinAnimations=function(t){D.instance.emit(E.SHOW_WIN_EFFECTS);for(var i,e=new Set,s=n(t);!(i=s()).done;)for(var r=i.value,o=g[r.lineIndex],l=0;l<y;l++)if(l<r.count){var a=o[l];e.add(this._cells[a][l])}e.forEach((function(t){t.playWinEffect()})),this.drawWinLines(t),this.scheduleOnce((function(){D.instance.emit(E.SPIN_ENDED)}),2.5)},o.drawWinLines=function(t){var i=this;this._lineGraphics&&(this._lineGraphics.clear(),t.forEach((function(t){var e=g[t.lineIndex],n=e[0],s=i._startX+0*i._cellWidth,r=i._startY-n*i._cellHeight;i._lineGraphics.moveTo(s,r);for(var o=1;o<t.count;o++){var l=e[o],a=i._startX+o*i._cellWidth,h=i._startY-l*i._cellHeight;i._lineGraphics.lineTo(a,h)}i._lineGraphics.stroke()})))},o.stopAllWinEffects=function(){for(var t=0;t<b;t++)for(var i=0;i<y;i++)this._cells[t][i].stopWinEffect();this._lineGraphics&&this._lineGraphics.clear()},o.update=function(t){if(this._isSpinning&&this._cells&&0!==this._cells.length)for(var i=this._spinSpeed,e=this._totalHeight,n=this._startY-(b-.5)*this._cellHeight,s=0;s<y;s++)if(this._columnSpinning[s])for(var r=0;r<b;r++){var o=this._cells[r][s],l=o.node,a=l.position.clone();if(a.y-=i*t,a.y<n){a.y+=e;var h=Math.floor(8*Math.random());h<0&&(h=0),h>=this.symbolFrames.length&&(h=0);var c=this.symbolFrames[h];o.setSymbol(h,c)}l.setPosition(a)}},i}(d)).prototype,"gridRoot",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(H.prototype,"symbolPrefab",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(H.prototype,"symbolFrames",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=i(H.prototype,"symbolAtlas",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(H.prototype,"atlasPrefix",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"symbol_"}}),N=H))||N));o._RF.pop()}}}));

System.register("chunks:///_virtual/SpinningState.ts",["cc","./EventBus.ts"],(function(n){var t,e,i;return{setters:[function(n){t=n.cclegacy},function(n){e=n.EventBus,i=n.GameEvent}],execute:function(){t._RF.push({},"99025svCVZERKD0Uo3dEjPy","SpinningState",void 0);n("SpinningState",function(){function n(){}var t=n.prototype;return t.enter=function(n){n.setSpinButtonInteractable(!1),e.instance.emit(i.SPIN_STARTED)},t.exit=function(n){},t.onSpinClicked=function(n){},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/SymbolView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,r,s,l,a,c,p,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,l=e.Sprite,a=e.UITransform,c=e.tween,p=e.Vec3,u=e.Component}],execute:function(){var h,f,y,w,d;r._RF.push({},"10aca9qgkVGlI1anQMulVn3","SymbolView",void 0);var m=s.ccclass,b=s.property;e("SymbolView",(h=m("SymbolView"),f=b(l),h((d=t((w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,i(t,"sprite",d,o(t)),t._symbolIndex=0,t._tween=null,t}n(t,e);var r=t.prototype;return r.onLoad=function(){var e=this.getComponent(a);e&&(e.width=180,e.height=180),this.sprite&&(this.sprite.sizeMode=l.SizeMode.CUSTOM)},r.setSymbol=function(e,t){this._symbolIndex=e,this.sprite&&(this.sprite.spriteFrame=t),this.stopWinEffect()},r.getSymbolIndex=function(){return this._symbolIndex},r.playWinEffect=function(){this._tween||(this._tween=c(this.node).to(.3,{scale:new p(1.2,1.2,1)},{easing:"sineOut"}).to(.3,{scale:new p(1,1,1)},{easing:"sineIn"}).union().repeatForever().start())},r.stopWinEffect=function(){this._tween&&(this._tween.stop(),this._tween=null),this.node.setScale(1,1,1)},t}(u)).prototype,"sprite",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=w))||y));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});